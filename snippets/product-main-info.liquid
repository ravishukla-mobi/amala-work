{%- liquid

  assign selected_variant = product.selected_or_first_available_variant
  assign vendor_handle = product.vendor | handle
  assign collection_for_vendor = collections[vendor_handle]
  assign latest_products = ""
  if settings.new_arrivals_allowed_count != blank
    assign allowed_new_arrivals = settings.new_arrivals_allowed_count
  else
    assign allowed_new_arrivals = 10
  endif
  paginate collections["new-arrivals"].products by allowed_new_arrivals
    for new_product in collections["new-arrivals"].products
      if latest_products == "" 
        assign latest_products = new_product.id   
      else
        assign latest_products = latest_products | append: ',' | append: new_product.id   
      endif
    endfor
  endpaginate

  assign allCol = product.collections | sort: 'published_at'
  assign home_fashion_pdp = false
  for col in allCol
    if col.handle == 'mens-wear' or col.handle == 'women' or col.handle == 'joyful-home'
      assign home_fashion_pdp = true
      break
    endif
  endfor
-%}

<style>
  .collpse-accoridian.manufacturer-tab .content-collepse2 p:not(:last-child) {
    font-size: 14px;
    margin-bottom: 0px;
  }
  table.manufacturer_table tbody {
    border: 1px solid #e2e2e2;
  }
  .manufacturer_table td{
    width: 100%;
  }
  .tag_icon_offers {
    padding-right: 5px;
  }
  .tag_icon_offers svg {
    height: 20px;
    width: 20px;
    transform: rotate(90deg);
    position: relative;
    top: 5px;
    fill: rgba(0, 0, 0, 0.6);
  }
  @media screen and (max-width: 767px) {
    .set-tab2 .content-collepse2 .manufacturer_table {
      margin-left: 0px;
    }
    .manufacturer_table th {
      min-width: 240px;
      padding: 10px;
    }
    .card .table.manufacturer_table th:first-child{
      padding-left: 17px;
    }
  }

  @media screen and (max-width: 639px) {
    .manufacturer_table th {
      min-width: 125px;
      padding: 10px;
      padding-left: 10px;
    }
    .card .table.manufacturer_table th:first-child{
      padding-left: 10px;
    }
  }
     
    .slider{
      max-width: 1100px;
      display: flex;
    }
    .slider .card{
      flex: 1;
      margin: 0;
      background: #fff;
    }

    .card .content .btn button:hover{
      transform: scale(0.9);
    }
    .dot {

      display: inline-block;
    }
      .pdpgrouping{        
        padding-top:0px !important;
        display:block;
      }
    .pdpgrouping .slick-list{
      padding-top:50px;
    }
  .pdpgrouping .slick-track{
    min-width:500px !important;
  }
      .pdpgrouping .card .dot a img{
        border: 3px solid #b89c7d;
        border-radius: 100px;
        padding: 0px;
        height: 45px;
        width: 45px;
        }
      .pdpgrouping .slider .card{
            flex: unset;
        text-align:center;
      }

       .pdpgrouping .slider .active:after {
        content: '\2713';
        display: inline-block;
        color: #fff;
        padding: 0 6px 0 0;
        position: absolute;
        font-size: 25px;
        left: 34%;
        top: 0;
        height: 50px;
        font-weight: bolder;
    }
      .pdpgrouping .slider .card .tooltip{
        display:none;
        position: absolute;
        top: -40px;
        width: max-content;
        text-align: left;
        left: 0;
        font-weight: bold;
        
      }
      .pdpgrouping .slider .active .tooltip{
        display:block;
        
    }
      .pdpgrouping .slider .card:hover .tooltip{
      	 display:block;
          background: #e2e2e2;
        padding: 2px 20px;
        margin-top: -12px;
        border-radius: 10px;
      
      }
      .pdpgrouping .slider .card:hover .tlp0{
            display: block;
            padding: 0;
            background: none;
            margin: 0;
      }
    @media (max-width:767px){
    .pdpgrouping{
        padding-top: 30px;
       padding-bottom: 10px;
    margin-left: 10px;
    }
  }
  .slick-arrow{
    position: absolute;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 50px;
    height: 50px;
    top: calc(50% - 25px);
    border-radius: 100%;
    visibility: visible;
    background: #0e0d0d;
    opacity: 0;
    transition: all .2s ease-in-out;
    transform: scale(.7);
    z-index: 1;
    margin-left: 40px;
  }
  .slick-arrow([disabled]) {
    transform: scale(1);
    opacity: 1;
}
</style>
<div class="card {% if product.media.size > 0 %}card--collapsed{% endif %} card--sticky">
  {%- if section.settings.enable_image_zoom -%}
  <div id="product-zoom-{{ section.id }}" class="product__zoom-wrapper"></div>
  {%- endif -%}

  <div class="card__section">
    {% comment %}
    ------------------------------------------------------------------------------
    PRODUCT META
    ------------------------------------------------------------------------------
    {% endcomment %}

    {%- if section.settings.show_share_buttons -%}
      {%- capture share_buttons -%}
        {%- assign share_url = shop.url | append: product.url -%}
        {%- assign twitter_text = product.title | url_param_escape -%}
        {%- assign pinterest_description = product.description | strip_html | truncatewords: 15 | url_param_escape -%}
        {%- assign pinterest_image = product.featured_media | img_url: '1024x' | prepend: 'https:' -%}
		<a href="https://www.facebook.com/sharer.php?u={{ share_url }}" target="_blank" rel="noopener" aria-label="{{ 'general.social.facebook_share' | t }}">{%- render 'icon', icon: 'facebook' -%}</a>
        {% comment %}<a href="https://pinterest.com/pin/create/button/?url={{ share_url }}{% if pinterest_image != blank %}&media={{ pinterest_image }}{% endif %}&description={{ pinterest_description }}" target="_blank" rel="noopener" aria-label="{{ 'general.social.pinterest_pin' | t }}">{%- render 'icon', icon: 'pinterest' -%}</a>
        <a href="https://twitter.com/share?{% if twitter_text != blank %}text={{twitter_text}}&{% endif %}url={{ share_url }}" target="_blank" rel="noopener" aria-label="{{ 'general.social.twitter_tweet' | t }}">{%- render 'icon', icon: 'twitter' -%}</a>{% endcomment %}
        <a href="mailto:?&subject={{ product.title | escape }}&body={{ share_url }}" aria-label="{{ 'general.social.email_share' | t }}">{% render 'icon', icon: 'email' %}</a>
    	<a href="whatsapp://send?text={{ share_url }}"  rel="noopener" data-msg="{{ share_url }}" class="whatsapp-share-main" aria-label="Share on Whatsapp">{%- render 'icon', icon: 'whatsapp' -%}</a>
      {%- endcapture -%}
    {%- endif -%}

    <div class="product-meta">
      <div class="product-info">
        <div class="product-info-left">
          <h1 class="product-meta__title heading h1">{{ product.title }}</h1>
          
          {%- capture product_labels -%}
          {% assign newtag_applied = 0 %} 
          {%- if latest_products contains product.id and product.available -%}
              {% assign newtag_applied = 1 %}  
               <span class="product-label product-label--custom1">New</span>
          {%- endif-%}
          {%- if product.available == false  -%}
               <span class="product-label product-label--custom1 notify-me">Notify me</span>
          {%- endif-%}
          {%- for tag in product.tags -%}
             {%- if product.available == false  -%}
            	 {%- break -%}
             {%- endif -%}
             {%- if newtag_applied == 1 -%}
                {%- break -%}
             {%- endif -%}
           {% assign current_tag_label = tag | split: '__label:' | last | downcase  %}
            {%- if current_tag_label == "new" -%}
              {%- continue -%}
            {%- endif -%}
          {%- if tag contains '__label:' -%}
          <span class="product-label product-label--custom1 {% if current_tag_label == "expert pick" %} expert-pick{% endif %}">{{ tag | split: '__label:' | last }}</span>
          {%- endif -%}

          {%- if tag contains '__label1:' -%}
          <span class="product-label product-label--custom1 {% if current_tag_label == "expert pick" %} expert-pick{% endif %}">{{ tag | split: '__label1:' | last }}</span>
          {%- endif -%}

          {%- if tag contains '__label2:' -%}
          <span class="product-label product-label--custom2 {% if current_tag_label == "expert pick" %} expert-pick{% endif %}">{{ tag | split: '__label2:' | last }}</span>
          {%- endif -%}
          {%- endfor -%}
          {%- endcapture -%}

          {%- if product_labels != blank -%}
          <div class="product-meta__label-list">
            {{- product_labels -}}
          </div>
          {%- endif -%}

        </div>
        <div class="product-seller-info-row">
          {%- if section.settings.show_vendor -%}
          <span class="product-meta__reference">
            {%- if section.settings.show_vendor -%}
            {%- unless collection_for_vendor.empty? -%}
            <a class="product-meta__vendor link link--accented" href="{{ collection_for_vendor.url }}">{{ product.vendor }}</a>
            {%- else -%}
            <a class="product-meta__vendor link link--accented" href="{{ product.vendor | url_for_vendor }}">{{ product.vendor }}</a>
            {%- endunless -%}
            {%- endif -%}

          </span>
          {%- endif -%}

          {%- if section.settings.show_vendor and section.settings.show_sku and selected_variant.sku != blank -%}
          <span class="product-meta-sap"> | </span>
          {%- endif -%}
          {%- if selected_variant.sku != blank and section.settings.show_sku  -%}
          <span class="product-meta__sku">
            {{- 'product.general.sku' | t -}} <span class="product-meta__sku-number">{{ selected_variant.sku }}</span>
          </span>
          {%- endif -%}

        </div>
      </div>
      
      {%- for tag in product.tags -%}
      {%- if tag contains '__stock:' -%}
      {%- assign stock_countdown_max = tag | split: '__stock:' | last | times: 1.0 -%}
      {%- assign stock_countdown_progress = selected_variant.inventory_quantity | divided_by: stock_countdown_max | times: 100.0 | at_least: 0 | at_most: 100 -%}

      <span class="inventory-bar {% if stock_countdown_progress == 0 %}inventory-bar--hidden{% endif %}" data-stock-countdown-max="{{ stock_countdown_max }}">
        <span class="inventory-bar__progress" style="width: 100%"></span>
      </span>
      {%- break -%}
      {%- endif -%}
      {%- endfor -%}
    </div>
    <div class="product_info_price_review_badge">
      <div class="product_info_price_review_badge-left">
        <div class="product-form__info-item product-form__info-price">
          {%comment%}<span class="product-form__info-title text--strong">{{ 'product.form.price' | t }}:</span>{%endcomment%}

          <div class="product-form__info-content" role="region" aria-live="polite">
            <div class="price-list actual-product-price">
              {%- if selected_variant.compare_at_price > selected_variant.price -%}
              <span class="price price--highlight">
                <span class="visually-hidden">{{ 'product.general.sale_price' | t }}</span>
                <span class="price-mrp">MRP </span>{{- selected_variant.price | money -}}
              </span>
              <span class="price price--compare">
                <span class="visually-hidden">{{ 'product.general.regular_price' | t }}</span>
                <del>{{- selected_variant.compare_at_price | money -}}</del>
              </span>
              {%- else -%}
              <span class="price price--highlight">
                <span class="visually-hidden">{{ 'product.general.sale_price' | t }}</span>
                <span class="price-mrp">MRP </span>{{- selected_variant.price | money -}}
              </span>
              {%- endif -%}

            </div>
            

              {%- if section.settings.show_discount -%}
              {%- assign savings = 0 -%}

              {%- capture savings -%}<span>{{ selected_variant.compare_at_price | minus: selected_variant.price | money }}</span>{%- endcapture -%}
              <span class="product-meta">
    <!--             <span class="product-label product-label--on-sale" {% unless selected_variant.price < selected_variant.compare_at_price %}style="display: none"{% endunless %}>{{ savings }}</span> -->
                {% assign discount_percentage = selected_variant.compare_at_price | minus: selected_variant.price | times: 100.0 | divided_by: selected_variant.compare_at_price | round | plus: 0 %}
                <span class="product-label product-label--p-sale" {% unless selected_variant.price < selected_variant.compare_at_price %}style="display: none" {% else %} {% if discount_percentage < 1 %}style="display: none" {% endif %}{% endunless %}>{{selected_variant.compare_at_price | minus: selected_variant.price | times: 100.0 | divided_by: selected_variant.compare_at_price | round | append: '%'}} OFF</span>
              </span>
              {%- endif -%}

            <div class="product-form__price-info" style="display: {% if selected_variant.unit_price_measurement %}block{% else %}none{% endif %}">
              <div class="unit-price-measurement">
                <span class="unit-price-measurement__price">{{ selected_variant.unit_price | money }}</span>
                <span class="unit-price-measurement__separator">/ </span>

                <span class="unit-price-measurement__reference-value" {%- if selected_variant.unit_price_measurement.reference_value == 1 -%}style="display: none"{% endif %}>
                  {{- selected_variant.unit_price_measurement.reference_value -}}
                </span>

                <span class="unit-price-measurement__reference-unit">{{ selected_variant.unit_price_measurement.reference_unit }}</span>
              </div>
            </div>

            {%- if section.settings.show_taxes_included -%}
            {%- if shop.taxes_included or shop.shipping_policy.body != blank -%}
            <p class="product-form__price-info">
              {%- if shop.taxes_included -%}
              {{ 'product.general.include_taxes' | t }}
              {%- endif -%}

              {%- if shop.shipping_policy.body != blank -%}
              {{ 'product.general.shipping_policy_html' | t: link: shop.shipping_policy.url }}
              {%- endif -%}
            </p>
            {%- endif -%}
            {%- endif -%}
          </div>
        </div>
       <div class="pdp_info_nectorcustom_review">
            {% render 'nectorcustom_review_rating', product: product, customer: customer, shop: shop %}
        </div>
      </div>
      <!-- brand score -->
      {%- assign vandor_collection = collections[vendor_handle] -%}
      {%- if vandor_collection.metafields.custom.brand_score != blank and vandor_collection.metafields.custom.brand_score != 0 -%}
      {%- assign brand_score = vandor_collection.metafields.custom.brand_score -%}
      {%- assign brand_score_img = 'brand_score_' | append: brand_score | append: '.png' -%}
      <div class="product_info_price_review_badge-right">
        <div class="brand_score_img lazyload" data-bg="{{ brand_score_img | asset_img_url: '120x' }}">
        </div>
      </div>
      {%- endif -%}
    </div>
    <div style='margin-top:20px'>
       {% render 'nectorcustom_customer_earning',
          shop: shop,
          customer: customer,
          product: product,
          coin_name: 'Earth Seeds',
          coin_per_unit_amount: 0.034,
          minimum_coin_amount: 1,
          fiat_amount_for_minimum_coin_amount: 1,
          background_color: '#eee',
          text_color: '#000',
          link_text_color: '#000',
          font_size: '14px',
          text_align: 'start'
        %}
      </div>
       <section class="grouping pdpgrouping">
        <div class="slider" id="groupingSlider">
          
        </div>
      </section>
      <!--stamped.io code-->
      {% comment %}
      <div class="product-rating-info-row">
        <!--stamped.io code
        <span class="stamped-product-reviews-badge stamped-main-badge" data-id="{{ product.id }}" data-product-sku="{{ product.handle }}" data-product-type="{{product.type}}" data-product-title="{{product.title}}" style="display: inline-block;">{{ product.metafields.stamped.badge }} </span> <span>{% assign review_count = product.metafields.stamped.reviews_count | plus: 0 %}{% if review_count > 0 %} {% else %} {% if customer %} <a href="#shopify-section-more-from-seller">Add Review</a> {% endif %}{% endif %} </span>
        <!--stamped.io code-->
        {%- render 'product-tags' -%}
      </div>
      {% endcomment %}
      {%comment%}
      <section class="diwali-offer-banner">
       {{ images['diwali-offer-banners.jpg'] | image_url: width:700 | image_tag }}
       </section> 
       {%endcomment%}
    {%- if section.settings.show_short_description and product.metafields.wk_custom_field['Short Description(150 char)'] != blank -%}
    <div class="product-meta__description rte">
      {{ product.metafields.wk_custom_field['Short Description(150 char)'] }}
    </div>
    {%- endif -%}

    {% comment %}
    ------------------------------------------------------------------------------
    PRODUCT FORM
    ------------------------------------------------------------------------------
    {% endcomment %}
  
  
    {%- assign color_label = 'color,colour,couleur,cor,colore,farbe,색,色,カラー,färg,farve,szín' | split: ',' -%}

    {%- form 'product', product, class: 'product-form' -%}


    {%- unless product.has_only_default_variant -%}
    <div class="product-form__variants {% if product.variants.size < 2 %} hide {% endif %}">
      {%- for option in product.options_with_values -%}
      {%- assign downcase_option = option.name | downcase -%}
      {%- capture option_name -%}{{ section.id }}-{{ product.id }}-{{ forloop.index }}{%- endcapture -%}

      {%- assign option_selector_type = 'select' -%}

      {%- if section.settings.color_mode != 'block' and section.settings.color_mode != 'dropdown' and color_label contains downcase_option -%}
      {%- comment -%}NOTE: even if the merchant is using the mode to display variant images, if ALL variant do not have an associated image, we fallback to color{%- endcomment -%}

      {%- assign has_image_attached_to_all_variants = true -%}

      {%- for variant in product.variants -%}
      {%- unless variant.image -%}
      {%- assign has_image_attached_to_all_variants = false -%}
      {%- break -%}
      {%- endunless -%}
      {%- endfor -%}

      {%- if section.settings.color_mode == 'color' or has_image_attached_to_all_variants == false -%}
      {%- assign option_selector_type = 'color' -%}
      {%- else -%}
      {%- assign option_selector_type = 'variant' -%}
      {%- endif -%}
      {%- else -%}
      {%- if color_label contains downcase_option -%}
      {%- if section.settings.color_mode == 'block' -%}
      {%- assign option_selector_type = 'block' -%}
      {%- endif -%}
      {%- elsif section.settings.selector_mode == 'block' -%}
      {%- assign option_selector_type = 'block' -%}
      {%- endif -%}
      {%- endif -%}

      <div class="product-form__option" data-selector-type="{{ option_selector_type }}">
        {%- case option_selector_type -%}
        {%- when 'color' -%}
        <span class="product-form__option-name text--strong">Choose {{ option.name }}: {%comment%}<span class="product-form__selected-value">{{ option.selected_value }}</span>{%endcomment%}</span>

        <div class="color-swatch-list color-swatch-list--large">
          {%- for value in option.values -%}
          {%- assign downcased_value = value | downcase -%}
          {%- capture color_id -%}{{ option_name }}-{{ forloop.index }}{%- endcapture -%}

          {%- assign color_swatch_name = value | handle | append: '.png' -%}
          {%- assign color_swatch_image = images[color_swatch_name] -%}

          <div class="color-swatch {% if downcased_value == 'white' or downcased_value == 'blanc' %}color-swatch--white{% endif %}">
            <input class="color-swatch__radio product-form__single-selector" type="radio" name="{{ option_name }}" id="{{ color_id }}" value="{{ value | escape }}" {% if option.selected_value == value %}checked{% endif %} data-option-position="{{ option.position }}">
            <label class="color-swatch__item lazyload" for="{{ color_id }}" {% if color_swatch_image != blank %}data-bg="{{ color_swatch_image | img_url: '64x64' }}"{% else %}style="background-color: {{ value | replace: ' ', '' | downcase }}"{% endif %} title="{{ value | escape }}">
              <span class="visually-hidden">{{ value }}</span>
              {%- render 'icon', icon: 'cross-sold-out' -%}
            </label>
          </div>
          {%- endfor -%}
        </div>
        {%- when 'variant' -%}
        <span class="product-form__option-name text--strong">Choose {{ option.name }} {%comment%}<span class="product-form__selected-value">{{ option.selected_value }}</span>{%endcomment%}</span>

        <div class="variant-swatch-list">
          {%- capture option_name -%}option{{ option.position }}{%- endcapture -%}

          {%- for value in option.values -%}
          {%- capture variant_swatch_id -%}{{ option_name }}-{{ forloop.index }}{%- endcapture -%}

          {%- for variant in product.variants -%}
          {%- if variant[option_name] == value and variant.image -%}
          <div class="variant-swatch">
            <input class="variant-swatch__radio product-form__single-selector" type="radio" name="{{ option_name }}" id="{{ variant_swatch_id }}" value="{{ value | escape }}" {% if option.selected_value == value %}checked{% endif %} data-option-position="{{ option.position }}">

            <label class="variant-swatch__item" for="{{ variant_swatch_id }}" title="{{ value | escape }}">
              <div class="aspect-ratio" style="padding-bottom: {{ 100.0 | divided_by: variant.image.aspect_ratio }}%">
                <img src="{{ variant.image | img_url: '120x' }}" alt="{{ variant.image.alt | escape }}">
              </div>

              {% render 'icon', icon: 'cross-sold-out' %}
            </label>
          </div>

          {%- break -%}
          {%- endif -%}
          {%- endfor -%}
          {%- endfor -%}
        </div>
        {%- when 'block' -%}
        <span class="swatch_required_msg hide">This is required</span>
        <span class="product-form__option-name text--strong">Choose {{ option.name }} {%comment%}<span class="product-form__selected-value">{{ option.selected_value }}</span>{%endcomment%}</span>

        <div class="block-swatch-list">
          {%- for value in option.values -%}
          {%- capture block_swatch_id -%}{{ option_name }}-{{ forloop.index }}{%- endcapture -%}

          <div class="block-swatch">
            {% if product.variants.size > 1 %}
            <input {{ product.variants.size}} class="block-swatch__radio product-form__single-selector" type="radio" name="{{ option_name }}" id="{{ block_swatch_id }}" value="{{ value | escape }}" data-option-position="{{ option.position }}">
            {% endif %}
            <label class="block-swatch__item" for="{{ block_swatch_id }}" title="{{ value | escape }}">
              <span class="block-swatch__item-text">{{ value }}</span>
            </label>
          </div>
          {%- endfor -%}
        </div>
        {%- when 'select' -%}
        <label for="{{ option_name }}" class="product-form__option-name text--strong">Choose {{ option.name }} {%comment%}<span class="product-form__selected-value">{{ option.selected_value }}</span>{%endcomment%}</label>

        <div class="select-wrapper select-wrapper--primary position-relative">
          {%- render 'icon', icon: 'select-left' -%}
         
         
          <span class="amala-tooltip d-none">This is required</span>
    
          <select class="product-form__single-selector" name="{{ option_name }}" id="{{ option_name }}" data-option-position="{{ option.position }}">
            {% if product.variants.size > 1 %}
            <option value="NA" {% unless product.selected_variant %} selected {% endunless %} >Select</option>
            {% endif %}
            {%- for value in option.values -%}
            <option value="{{ value | escape }}" >{{ value }}</option>
            {%- endfor -%}
          </select>
        </div>
        {%- endcase -%}
        <div class="product-form__option_chart">
        	{% for image in product.images %}
          {% assign image_src = image.src | downcase %}
    			{% if image_src contains 'sizechart' %}  
          <a class="trigger-pop-up btn" data-image="{{ image.src | img_url: "master" }}">Size Chart</a>
      			{% endif %}
    		{% endfor %}
        </div> 
      </div>
      {%- endfor -%}

      <div class="no-js product-form__option">
        <label for="product-select-{{ product.id }}">{{ 'product.form.variant' | t }}</label>

        <div class="select-wrapper select-wrapper--primary">
          <select id="product-select-{{ product.id }}" name="id">
            {%- for variant in product.variants -%}
            <option {% if variant == selected_variant %}selected="selected"{% endif %} {% unless variant.available %}disabled="disabled"{% endunless %} value="{{ variant.id }}" data-sku="{{ variant.sku }}">{{ variant.title }} - {{ variant.price | money }}</option>
            {%- endfor -%}
          </select>
        </div>
      </div>
    </div>
    {%- else -%}
    <input type="hidden" name="id" data-sku="{{ selected_variant.sku }}" value="{{ selected_variant.id }}">
    {%- endunless -%}

    <div class="product-form__info-list">
      {%- if product.template_suffix != 'contact' -%}
      {%- if section.settings.show_quantity_selector -%}
      <div class="product-form__info-item product-form__info-item--quantity">
        <label for="{{ section.id }}-{{ product.id }}-quantity" class="product-form__info-title text--strong">{{ 'product.form.quantity' | t }}</label>
        <div class="product-form__info-content">
          <div class="quantity-selector quantity-selector--product">
            <button type="button" class="quantity-selector__button" data-action="decrease-picker-quantity" aria-label="{{ 'cart.items.decrease_quantity' | t }}" title="{{ 'cart.items.decrease_quantity' | t }}">{% render 'icon', icon: 'minus' %}</button>
            <input name="quantity" aria-label="{{ 'product.form.quantity' | t }}" class="quantity-selector__value" inputmode="numeric" value="1" size="3">
            <button type="button" class="quantity-selector__button" data-action="increase-picker-quantity" aria-label="{{ 'cart.items.increase_quantity' | t }}" title="{{ 'cart.items.increase_quantity' | t }}">{% render 'icon', icon: 'plus' %}</button>
          </div>
        </div>
      </div>
      <div class='nector-buy-with-coins-mobile'>
       {%- render 'nectorcustom_buywithcoins_button', type: 'product', product: product,buywithcoins_button_classes:'product-form__payment-container cutom-button nector-buy-with-coins-button' %}
      </div>
      {%- else -%}
      <input type="hidden" name="quantity" value="1">
      {%- endif -%}
      {%- endif -%}


      {%- if section.settings.show_inventory_quantity and product.template_suffix != 'pre-order' -%}
      <div class="product-form__info-item">
        <div class="product-form__info-content">
          {%- if selected_variant.available -%}
          {%- if selected_variant.inventory_management and selected_variant.inventory_policy == 'deny' and section.settings.low_inventory_threshold > 0 -%}
          {%- if selected_variant.inventory_quantity <= section.settings.low_inventory_threshold -%}
          <span class="product-form__inventory inventory inventory--low">{{ 'product.form.low_stock_with_quantity_count' | t: count: selected_variant.inventory_quantity }}</span>
          {%- else -%}
          {%- comment -%}
          <span class="product-form__inventory inventory inventory--high">{{ 'product.form.in_stock_with_quantity_count' | t: count: selected_variant.inventory_quantity }}</span>
          {%- endcomment -%}
          {%- endif -%}
          {%- else -%}
          {%- if selected_variant.inventory_policy == 'continue' and selected_variant.inventory_quantity <= 0 and selected_variant.requires_shipping -%}
          <span class="product-form__inventory inventory inventory--high">{{ 'product.form.oversell_stock' | t }}</span>
          {%- else -%}
          {%- comment -%}
          <span class="product-form__inventory inventory inventory--high">{{ 'product.form.in_stock' | t }}</span>
          {%- endcomment -%}
          {%- endif -%}
          {%- endif -%}
          {%- else -%}
<!--           <span class="product-form__inventory inventory">{{ 'product.form.sold_out' | t }}</span> -->
          {%- endif -%}

        </div>
      </div>
      {%- endif -%}

      
      <div class="price-list hide">
        {%- if selected_variant.compare_at_price > selected_variant.price -%}
        <span class="price price--highlight">
          <span class="price price--label">Price </span>
          <span class="dynamic_quantity_actual_price" data-value="{{- selected_variant.price -}}">{{- selected_variant.price | money -}}</span>
        </span>
        {%comment%}
        <span class="price price--compare">
          <span class="visually-hidden">{{ 'product.general.regular_price' | t }}</span>
          <del class="dynamic_quantity_comp_price" data-value="{{- selected_variant.compare_at_price -}}">{{- selected_variant.compare_at_price | money -}}</del>
        </span>
        {%endcomment%}
        {%- else -%}
        <span class="price price--highlight">
          <span class="visually-hidden">Price</span>
          <span class="dynamic_quantity_actual_price" data-value="{{- selected_variant.price -}}">{{- selected_variant.price | money -}}</span>
        </span>
        {%- endif -%}
      </div>
      
    </div>

    <!-- Start: To show the cashback by Wallet app -->
    <div class="wk_cashback_product" product_id="{{ product.id }}"></div>
    <!-- End: To show the cashback by Wallet app -->
    
    <div class="product-form__payment-container hide-for-mobile{% unless section.settings.show_payment_button %} full-width__add-button{% endunless %}">
      <!-- wishlist-king Code -->
    <!-- include 'wishlist-button-product-without-text' with '{{ product.id }}' -->
    <!-- End wishlist-king Code -->
    <div class="product-gift__block">
      <ul>
        <li class="share-product__row">
          <div class="share-button__col">
          {%- render 'icon', icon: 'share-icon-new' -%}
          </div>
          <div class="share-icon__col">
            {%- if section.settings.show_share_buttons -%}
            {{ share_buttons }}
            {%- endif -%}
          </div>
        </li>
      </ul>
    </div>
      {%- if product.template_suffix != 'contact' -%}
      {%- if selected_variant.available -%}
      {%- if product.template_suffix == 'pre-order' -%}
      <button type="submit"  class="main_product_cart_btn product-form__add-button button button--primary cutom-button" data-action="add-to-cart" data-product-handle="{{ product.handle }}" data-variant-id="{{ product.selected_or_first_available_variant.id }}">{{ 'product.form.pre_order' | t }}</button>
      {%- else -%}
      <button type="submit"  class="main_product_cart_btn product-form__add-button button button--primary cutom-button" data-action="add-to-cart" data-product-handle="{{ product.handle }}" data-variant-id="{{ product.selected_or_first_available_variant.id }}">{{ 'product.form.add_to_cart' | t }}</button>
      {%- endif -%}
      {%- else -%}
        <button type="submit" class="product-form__add-button button button--disabled cutom-button" data-action="add-to-cart" disabled>{{ 'product.form.sold_out' | t }}</button>
        
      {%- endif -%}

       <!-- Adding Back in Stock button code -->  
        <a href="#" id="BIS_trigger" class="product-form__add-button button button--primary cutom-button" {% if selected_variant.available %}style="display: none;"{% endif %}>Notify Me</a>
        <!-- EOF Adding Back in Stock button code -->
      

      {%- if section.settings.show_payment_button and product.template_suffix != 'pre-order' -%}
      {{ form | payment_button }}
      {%- endif -%}
      {%- else -%}
      <a href="mailto:{{ shop.email }}" class="button button--primary cutom-button">{{ 'product.form.contact_us' | t }}</a>
      {%- endif -%}

    </div>
    
    <div class="sticky-on-mobile">
         {% if  product.tags contains 'has_bundle' %}
    
    {% for tag in product.tags %}
		{% if tag contains 'bundle_' %}  
			{% assign slug = tag | split:'_' | last %}
        {% elsif tag contains 'bundlecount' %}
			{% assign bundlecount = tag | split:'_' | last %}
        	
        {% endif %}
   	{% endfor %}
    {% assign product_obj = all_products[slug] %}
    {% assign alone_price = product.price | times: bundlecount %}
     {% assign saving_amount = product_obj.compare_at_price | minus: product_obj.price | money %} 
        <div class="additional-product">
         <div class="ap-img"><img src="{{ product_obj.images.first.src | img_url: '100x' }}" alt="{{ product_obj.image.alt | escape }}"></div>
          <div class="ap-title">Get pack of {{bundlecount}} at {{product_obj.price | money}} <br><del>{{product_obj.compare_at_price  | money }}</del> Save {{saving_amount}}</div>
          <div class="ap-btn"><div id="details_btn" class="button details_btn{% unless product_obj.variants.first.available %} button--disabled{% endunless %}" data-id="{{product_obj.variants.first.id}}">{% if product_obj.variants.first.available %}Add to Cart{% else %}Sold Out{% endif %}</div></div>
        </div>
     {% endif %}
        {% if  product.tags contains 'has_combo' %}
          {% for tag in product.tags %}
            {% if tag contains 'combo_' %}  
              {% assign slug = tag | remove: "combo_" %}
            {% elsif tag contains 'combocount' %}
              {% assign combocount = tag | split:'_' | last %}
            {% endif %}
          {% endfor %}
          {% assign combo_product_obj = all_products[slug] %}
          {% assign total_price = combo_product_obj.price | plus: product.price %}
          {% if product.compare_at_price == 0 %}
              {% assign compare_price1 = product.price %}
          {% else %}
              {% assign compare_price1 = product.compare_at_price %}
          {% endif %}
          {% if combo_product_obj.compare_at_price == 0 %}
              {% assign compare_price2 = combo_product_obj.price %}
          {% else %}
              {% assign compare_price2 = combo_product_obj.compare_at_price %}
          {% endif %}
          {% assign total_compare_price = compare_price1 | plus: compare_price2 %}
          {% assign combo_saving_amount = compare_price1 | plus: compare_price2 | minus: total_price %}
          {% assign combo_product_avl = false %}
          {% if combo_product_obj.available and product.available %}
            {% assign combo_product_avl = true %}
          {% endif %}
          {% if combo_product_avl %}
          <div class="additional-product combo-product " 
            aria-controls="modal-quick-view-{{ section.id }}" 
            data-product-url="{{ all_products[slug].url }}">
            <div class="ap-img"><img src="{{ product.featured_image | img_url: '100x' }}" alt="{{ combo_product_obj.image.alt | escape }}"></div>
            <div class="img-separator">+</div>
            <div class="ap-img"><img src="{{ combo_product_obj.images.first.src | img_url: '100x' }}" alt="{{ combo_product_obj.image.alt | escape }}"></div>
            <div class="ap-title">Get combo at {{ total_price | money }} <br>
            {% if combo_saving_amount > 0 %}
              <del>{{ total_compare_price | money }}</del> Save {{combo_saving_amount | money }}
            {% endif %}
            </div>
            <div class="ap-btn"><div id="details_btn" class="button details_btn" data-product-url="{{ all_products[slug].url }}" data-id="{{combo_product_obj.variants.first.id}}">></div></div>
          </div>
        {% endif %}  
        {% endif %}        
        <div class="wishlist-sticky"></div>
        <div class="product-gift__block mobile-sticky-share-icon">
          <ul>
            <li class="share-product__row">
              <div class="share-button__col">
              {%- render 'icon', icon: 'share-icon' -%}
              </div>
              <div class="share-icon__col">
                {%- if section.settings.show_share_buttons -%}
                {{ share_buttons }}
                {%- endif -%}
              </div>
            </li>
          </ul>
        </div>
        <div class="mobile-sticky-payment-btn-wrap{% unless selected_variant.available %} hide{% endunless %}">
        {%- if product.template_suffix == 'pre-order' -%}
        <button type="submit" disabled class="main_product_cart_btn product-form__add-button button button--primary cutom-button" data-action="add-to-cart" data-product-handle="{{ product.handle }}" data-variant-id="{{ product.selected_or_first_available_variant.id }}">{{ 'product.form.pre_order' | t }}
        
        {%- if selected_variant.compare_at_price > selected_variant.price -%}
          <span class="price price--highlight" data-price="{{selected_variant.price}}">
            {{- selected_variant.price | money -}}
          </span>

          {%- else -%}
          <span class="price price--highlight" data-price="{{selected_variant.price}}">
            {{- selected_variant.price | money -}}
          </span>
          {%- endif -%}
        
        </button>
        {%- else -%}
        <button type="submit" class="main_product_cart_btn product-form__add-button button button--primary cutom-button" data-action="add-to-cart" data-product-handle="{{ product.handle }}" data-variant-id="{{ product.selected_or_first_available_variant.id }}">{{ 'product.form.add_to_cart' | t }}
        {%- if selected_variant.compare_at_price > selected_variant.price -%}
          <span class="price price--highlight" data-price="{{selected_variant.price}}">
            {{- selected_variant.price | money -}}
          </span>

          {%- else -%}
          <span class="price price--highlight" data-price="{{selected_variant.price}}">
            {{- selected_variant.price | money -}}
          </span>
          {%- endif -%}
        </button>
        {%- endif -%}
        </div>
        <div class="mobile_sticky_notify_soldout_wrap{% if selected_variant.available %} hide{% endif %}">
          <button type="submit" class="product-form__add-button button button--disabled cutom-button" disabled>{{ 'product.form.sold_out' | t }}</button>
          <!-- Adding Back in Stock button code -->
          <a href="#" id="BIS_trigger" class="product-form__add-button button button--primary cutom-button">Notify Me</a>
          <!-- EOF Adding Back in Stock button code -->
        </div>
      </div>
    {%- endform -%} 
    {%- if section.settings.offers != blank -%}
      <div class="available-Offers--wrapper ">
        <h3 class="heading hdng-t"><span class="tag_icon_offers"><svg fill="#222" height="16" viewBox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M16 8L8 0H0V8L8 16L16 8ZM4.5 6C5.32843 6 6 5.32843 6 4.5C6 3.67157 5.32843 3 4.5 3C3.67157 3 3 3.67157 3 4.5C3 5.32843 3.67157 6 4.5 6Z" fill-rule="evenodd"/></svg></span> Available Offers</h3>
        <div class="available-Offers--list ">
          {{ section.settings.offers }}
        </div>
      </div>
    {%- endif -%}
    {% comment %} Delivery Day code {% endcomment %}
    {%- assign CheckNCOD = false -%}
    {%- assign pro_vendor = product.vendor | strip -%}
    {% assign vendorslist  = settings.vendorslist_ncod | split: "|" %}
    {% if vendorslist contains pro_vendor %}
      {%- assign CheckNCOD = true -%}
    {% endif %}
    <div id="estimated_delivery">
      <span class="title">Estimated Delivery details</span>
      <div class="delivery-section">
        <div method="post" id="estimate_delivery" data-variant-id="{{ product.selected_or_first_available_variant.id }}" data-product-weight="{{ product.selected_or_first_available_variant.weight }}" data-vendor-ncod="{% if CheckNCOD %}true{% else %}false{% endif %}">
          <span class="form-grouping">
            <div class="form__input-wrapper form__input-wrapper--labelled">
              <input type="text" class="form__field" name="pin_code" id="pin_code_to" placeholder="" maxlength="6" value="">
              <label for="pin_code_to" class="form__floating-label">Enter PIN code</label>
            </div>
            <div class="pin_code-submit">
              <button type="submit"> Check </button>
              <span class="loader_span load"></span>
            </div>
            <span class="cross-submit hide_cross">{%- render 'icon', icon: 'cross-black' -%}</span>
          </span>
        </div>
        {% assign days = product.metafields.AE_PROD_DTLS['Package Preparation Days'] %}
        <p class="error_msg"></p>
        <div class="delivery_msg hide_delivery">
          <table>
            <thead>
              <tr>
                <td>Availability</td>
                <td>Payment Option</td>
                <td id="packing_time" data-packing-time="{% if days %} {{days}} {% else %} 2 {% endif %}">Expected Delivery</td>
              </tr>
            </thead>
            <tbody>
              <tr class="prepaid">
                <td> {%- render 'icon', icon: 'greencheck' -%}</td>
                <td>Online Payment</td>
                 <td class="estimate_date">Thursday, 30 July</td>
              </tr>
              <tr class="cod {% if product.price_min > 200000 %} no-display{% endif%}">
                <td> {% if CheckNCOD %}{%- render 'icon', icon: 'redcross' -%}{% else %}{%- render 'icon', icon: 'greencheck' -%}{% endif %}</td>
                <td>Cash on Delivery</td>
                 <td class="estimate_date">Tuesday, 12 July</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    {%- if home_fashion_pdp -%}
      {%- if product.metafields.custom.you_might_be_interested_in != blank and section.settings.show_similar_product_metafield -%}
        {% render 'pdp-viewsimilar-metafield', section:section,block:block %}
      {%- endif -%}
    {%- endif -%}

    {%- for block in section.blocks -%}
    {%- case block.type -%}
      {%- when 'style_the_look' -%}
        {%- if block.settings.show_style_the_look -%}
          <div class="style_the_look_block">
            <div id="th_pb_qty_bundle" class="th_pb_qty_bundle_cls" data-pid="{{ product.id }}"></div>
            <div class="style_look_product_heading"><h2 class="section__title heading h3">{{section.settings.limited_combo_offer_header}}</h2></div>
            <div class="th_pb_section" id="th_product_bundle" data-id="{{ product.id }}"></div>
            <div class="th_pb_fbt_section" data-thpid="{{ product.id }}"></div>
          </div>
        {%- endif -%}
      {%- endcase -%}
    {%- endfor -%}

    {%- if home_fashion_pdp == false -%}
      {%- if product.metafields.custom.you_might_be_interested_in != blank and section.settings.show_similar_product_metafield -%}
        {% render 'pdp-viewsimilar-metafield', section:section,block:block %}
      {%- endif -%}
    {%- endif -%}
    {%- comment -%}The availability container will be added automatically if there is store pickup available{%- endcomment -%}
    {%- if section.settings.show_pickup_availability -%}
    <div class="product-meta__store-availability-container"></div>
    {%- endif -%}
    
    {% comment %}
    ------------------------------------------------------------------------------
    Pin code and Share code row
    ------------------------------------------------------------------------------
    {% endcomment %}
    
    {% if  product.tags contains 'has_bundle' %}
    
    
    
    <div class="additional-product hide-for-mobile">
          <div class="ap-img"><img src="{{ product_obj.images.first.src | img_url: '100x' }}" alt="{{ product_obj.image.alt | escape }}"></div>
          <div class="ap-title">Get pack of {{bundlecount}}  at {{product_obj.price | money}} <br><del>{{product_obj.compare_at_price  | money }}</del> Save {{saving_amount}}</div>
     	
          <div class="ap-btn"><div id="details_btn details_btn" class="button details_btn{% unless product_obj.variants.first.available %} button--disabled{% endunless %}" data-id="{{product_obj.variants.first.id}}">{% if product_obj.variants.first.available %}Add to Cart{% else %}Sold Out{% endif %}</div></div>
        </div> 
    
    {% endif %}
    {% if  product.tags contains 'has_combo' %}
      {% if combo_product_avl %}
      <div class="additional-product combo-product hide-for-mobile" 
        aria-controls="modal-quick-view-{{ section.id }}" 
        data-product-url="{{ all_products[slug].url }}">
        <div class="ap-img"><img src="{{ product.featured_image | img_url: '100x' }}" alt="{{ combo_product_obj.image.alt | escape }}"></div>
        <div class="img-seprator">+</div>
        <div class="ap-img"><img src="{{ combo_product_obj.images.first.src | img_url: '100x' }}" alt="{{ combo_product_obj.image.alt | escape }}"></div>
        <div class="ap-title">Get combo at {{ total_price | money }} <br>
          {% if combo_saving_amount > 0 %}
            <del>{{ total_compare_price | money }}</del> Save {{combo_saving_amount | money }}
          {% endif %}
        </div>
        <div class="ap-btn"><div id="details_btn" class="button details_btn" data-product-url="{{ all_products[slug].url }}" data-id="{{combo_product_obj.variants.first.id}}">></div></div>
      </div>
      {% endif %}
    {% endif %}
    
    <div class="hide-for-mobile">
      {% render 'product-policy' %}
    </div>

    {% comment %} {% render 'pdp-product-description' %} {% endcomment %}

{% comment %} <div class="your-question product-descrip"> 
      <div class="set-tab2 collpse-accoridian">
        <h3 class="hdng-t active">Product Details</h3>
        <div class="content-collepse2" style="display: block;">
            {% render 'product-details-table' %}
        </div>
      </div>
      {% assign desc = product.description %}
      {% if desc == blank %}
        {% assign desc = product.metafields.custom.product_description %}
      {% endif %}
      
      {% if desc != blank %}
        <div class="set-tab2 collpse-accoridian">
          <h3 class="hdng-t">Product Description</h3>
          <div class="content-collepse2" >
            <p>{{ desc }}</p>
          </div>
        </div>
      {% endif %}
      {% assign benefits = product.metafields.AE_PROD_DTLS['Benefits'] %}
      {% if benefits != blank %}
            <div class="set-tab2 collpse-accoridian">
              <h3 class="hdng-t active">Benefits</h3>
              <div class="content-collepse2" style="display: block;">
                  <ul>
                  {% for item in product.metafields.AE_PROD_DTLS['Benefits'] %}
                    <li>{{ item }}</li>
                    {% endfor %}
                  </ul>
              </div>
            </div>
      {% else %}
          {% assign benefits = product.metafields.custom.product_benefits %}
       
          {% if benefits != blank %}
            <div class="set-tab2 collpse-accoridian">
              <h3 class="hdng-t active">Benefits</h3>
              <div class="content-collepse2" style="display: block;">
                <ul>
                {% for benefit in benefits.value %}
                  <li>{{ benefit }}</li>
                {% endfor %}
                </ul>
              </div>
            </div>
        
          {% endif %}
      {% endif %}
            
            
      {% assign manufacturer = product.metafields.AE_PROD_DTLS['Manufacturer Details'] %}
      {% if manufacturer == blank %}
          {% assign manufacturer = product.metafields.custom.manufacturer_name %}
      {% endif %}
      {% assign country_of_origin = product.metafields.AE_PROD_DTLS['Country Of Origin'] %}
      {% assign packer_details = product.metafields.AE_PROD_DTLS['Packer Details'] %}
            
            
      {% if manufacturer != blank or country_of_origin != blank or packer_details != blank %}
        <div class="set-tab2 collpse-accoridian manufacturer-tab">
            <h3 class="hdng-t">Name of Manufacturer</h3>
            <div class="content-collepse2">
              <table class="manufacturer_table product-ups__col table table-sm small">
                <tbody>
                  {% if manufacturer != blank %}
                    <tr>
                      <th>Manufacturer Details</th>
                      <td>{{ manufacturer }}</td>
                    </tr>
                  {% endif %}
                  {% if packer_details != blank %}
                    <tr>
                      <th>Packer Details</th>
                      <td>{{ packer_details }}</td>
                    </tr>
                  {% endif %}
                  {% if country_of_origin != blank %}
                    <tr>
                      <th>Country Of Origin</th>
                      <td>{{ country_of_origin }}</td>
                    </tr>
                  {% endif %}
                </tbody>
              </table>
            </div>
          </div>
      {% endif %}
        <div class="set-tab2 collpse-accoridian hide-for-desktop">
          <h3 class="hdng-t">Policy</h3>
          <div class="content-collepse2">
            {% render 'product-policy'%}
          </div>
        </div>
    </div>
{% endcomment %}
  </div> 

  {%- if section.settings.show_payment_button and product.selected_or_first_available_variant.available == false -%}
  <style>
    #shopify-section-{{ section.id }} .shopify-payment-button {
      display: none;
    }
  </style>
  {%- endif -%}

  {% comment %}
  ------------------------------------------------------------------------------
  Product Data. This must be outputted for all products (including home page).

  IMPORTANT: THIS CODE IS VITAL. DO NOT EDIT IT NOT REMOVE IT. MAKE SURE TO KEEP
  THE EXACT SAME ATTRIBUTES.
  ------------------------------------------------------------------------------
  {% endcomment %}
  
  <script>
   $(document).ready(function(){
	$('.share-button__col').click(function() {
       $(".share-icon__col").toggleClass("show");
      
     })

     vendorMsgFunc(`{{product.id}}`, `{{product.vendor}}`);
   })
</script>
  <script type="application/json" data-product-json>
    {
      "product": {{ product | json }},
      "options_with_values": {{ product.options_with_values | json }},
      "selected_variant_id": {{ selected_variant.id }}
      {%- if section.settings.show_inventory_quantity -%}
        ,"inventories": {
          {%- for variant in product.variants -%}
            {%- if variant.available -%}
              {%- if variant.inventory_management and variant.inventory_policy == 'deny' and section.settings.low_inventory_threshold > 0 -%}
                {%- if variant.inventory_quantity <= section.settings.low_inventory_threshold -%}
                  {%- capture inventory_message -%}{{ 'product.form.low_stock_with_quantity_count' | t: count: variant.inventory_quantity }}{%- endcapture -%}
                {%- else -%}
                  {%- capture inventory_message -%}{{ 'product.form.in_stock_with_quantity_count' | t: count: variant.inventory_quantity }}{%- endcapture -%}
                {%- endif -%}
              {%- else -%}
                {%- if variant.inventory_policy == 'continue' and variant.inventory_quantity <= 0 and selected_variant.requires_shipping -%}
                  {%- capture inventory_message -%}{{ 'product.form.oversell_stock' | t }}{%- endcapture -%}
                {%- else %}
                  {%- capture inventory_message -%}{{ 'product.form.in_stock' | t }}{%- endcapture -%}
                {%- endif -%}
              {%- endif -%}
            {%- else -%}
              {%- capture inventory_message -%}{{ 'product.form.sold_out' | t }}{%- endcapture -%}
            {%- endif -%}

            "{{ variant.id }}": {
              "inventory_management": {{ variant.inventory_management | json }},
              "inventory_policy": {{ variant.inventory_policy | json }},
              "inventory_quantity": {{ variant.inventory_quantity | json }},
              "inventory_message": {{ inventory_message | json }}
            }{% unless forloop.last %},{% endunless %}
          {%- endfor -%}
        }
      {%- endif -%}
    }
  </script>
</div>

{% comment %}
{% if product.tags contains 'has_bundle' %}
<div id="modal-quick-view-{{ section.id }}" class="modal quick-view-product-modal bundled-products-modal" aria-hidden="true">
    <div class="modal__dialog modal__dialog--stretch" role="dialog">
        <button class="modal__close link" data-action="close-modal" title="{{ 'general.accessibility.close' | t | escape }}">✖</button>
        <div class="modal__loader">
            {%- render 'icon', icon: 'search-loader' -%}
        </div>
        <div class="modal__inner"></div>
    </div>
</div>
{% endif %}
{% endcomment %}

{% if  product.tags contains 'has_combo' %}
  {%- comment -%}
  --------------------------------------------------------------------------------------
  QUICK VIEW CONTAINER
  --------------------------------------------------------------------------------------
  {%- endcomment -%}

<style type="text/css">
    .combo-product-modal h3 {
        font-size: 20px;
        text-align: center;
        font-weight: 500;
    }
    .popup-base-product {
        position: relative;
        margin-bottom:40px;
    }
    .popup-base-product:before,.popup-base-product::after {
        content: '';
        position: absolute;
        width: 25px;
        height: 3px;
        background-color: gray;
        left:calc(50% - 10px);
        bottom:-20px;
    }
    .popup-base-product::after {
        transform: rotate(90deg);
    }
    .popup-combo-all {
        padding: 15px;
        display: flex;
        flex-wrap: wrap;
        background-color: #eee;
        border-radius: 8px;
    }
    #common-popup-image {
        width: 100px;
    }
    #common-popup-image img {
        width: 100%;
    }
    #common-popup-details {
        width: calc(100% - 115px);
        padding-left: 10px;
    }
    #common-popup-details h2 {
        font-size: 15px;
        font-weight: 600;
    }
    #common-popup-details p {
        font-size: 15px;
        font-weight: 700;
        color:#945539;
    }
    @media(max-width:768px) {
        #common-popup-details h2 {
            font-size: 13px;
        }
        .combo-product-modal {
            padding: unset !important;
        }
        .popup-combo-all {
            margin-left: 10px;
            margin-right: 10px;
        }
    }
    .combo-product-modal {
        padding: 15px;
    }
    .combo-product-modal .modal__dialog {
        width: auto;
    }
    .combo-buttons-block {
        text-align: center;
        margin-top: 15px;
    }
    .combo-buttons-block .cartbutton {
        background: #b97d58 !important;
    }
    .combo-product-modal .modal__close {
        padding: 5px 10px;
    }
    @media(max-width:640px) {
        .combo-product-modal .modal__close {
            top: -40px !important;
            padding: unset !important;
        }
        .sticky-on-mobile-combo {
            display: flex;
            position: fixed;
            flex-wrap:wrap;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 8px;
            background: #fff;
            z-index: 2;
            box-shadow: 0 0 5px #aaa;
        }
        .sticky-on-mobile-combo .cutom-button {
            width: 80%;
            max-width: 100% !important;
            flex: 0 0 calc(100% - 65px) !important;
            background: #b97d58;
        }
        .sticky-on-mobile-combo .cutom-button .price {
            font-size: 17px;
            color: #fff;
            font-weight: 600;
            margin-left: 15px;
        }
    }
    @media screen and (max-width: 968px) {
        .combo-product-modal {
            height: 80vh !important;
        }
    }
    .combo-wishlist .wk-button-product {
        border: 2px solid #b97d58;
        position: relative;
        opacity: 1 !important;
        top: 0;
        padding: 0;
        background: var(--white-color);
        border-radius: 10px;
        height: 54px;
        line-height: 40px;
        width: 54px!important;
        max-width: 100%;
        margin-right: 0;
        min-width: 54px;
        margin: 0!important;
        margin-right: 8px !important;
    }
    .combo-wishlist .wk-button-product .wk-icon {
        width: 24px;
    }
    .combo-wishlist .wk-button {
        border: 2px solid #b97d58 !important;
        position: relative !important;
        opacity: 1!important !important;
        top: 0 !important;
        padding: 0 !important;
        background: var(--white-color) !important;
        border-radius: 10px !important;
        height: 54px !important;
        line-height: 40px !important;
        width: 54px!important;
        max-width: 100% !important;
        margin-right: 0 !important;
        min-width: 54px !important;
        margin: 0 8px 0 0!important;
    }
    .combo-wishlist .wk-button .wk-icon {
        width: 28px !important;
        height: 22px !important;
        position: absolute !important;
        left: 50% !important;
        top: 50% !important;
        transform: translate(-50%, -50%) !important;
    }
    .combo-wishlist .wk-button__label {
        display: none !important;
    }
    .comb-button {
        display: flex;
        margin-left: 20%;
    }
    @media(max-width:968px) {
        .combo-product-modal {
            height: 455px !important;
        }
        .quick-view-product-modal.combo-product-modal .modal__inner{
            height: 100%;
        }
    }
</style>  
<div id="modal-quick-view-{{ section.id }}" class="modal quick-view-product-modal combo-product-modal" aria-hidden="true">
    <div class="modal__dialog modal__dialog--stretch" role="dialog">
        <button class="modal__close link" data-action="close-modal" title="{{ 'general.accessibility.close' | t | escape }}">✖</button>
        <div class="modal__loader">
            {%- render 'icon', icon: 'search-loader' -%}
        </div>
        <div class="modal__inner">
            <div id="quick-view-modal" class="card card--sticky combo-product-modal">
                <h3>Buy Combo, Save More</h3>
                <div class="popup-base-product popup-combo-all">
                    <div class="popup-base-image" id="common-popup-image">
                        <img src="{{ product.featured_image | img_url: '500x' }}">
                    </div>
                    <div class="popup-base-details" id="common-popup-details">
                        <h2>{{ product.title | escape }}</h2>
                        <p>{{ product.price | money }}</p>
                    </div>
                    <input type="hidden" id="popup-base-variant-id" value="{{ product.selected_or_first_available_variant.id }}">
                </div>
                {% for tag in product.tags %}
                    {% if tag contains 'combo_' %}  
                        {% assign slug = tag | remove: "combo_" %}
                    {% elsif tag contains 'combocount' %}
                        {% assign combocount = tag | split:'_' | last %}
                    {% endif %}
                {% endfor %}
                {% assign combo_product_list = all_products[slug] %}
                <div class="popup-combo-products popup-combo-all">
                    <div class="popup-combo-image" id="common-popup-image">
                        <img src="{{ combo_product_list.featured_image | img_url: '500x' }}">
                    </div>
                    <div class="popup-combo-details" id="common-popup-details">
                        <h2>{{ combo_product_list.title | escape }}</h2>
                        <p>{{ combo_product_list.price | money }}</p>
                    </div>
                    <input type="hidden" id="popup-combo-variant-id" value="{{ combo_product_list.selected_or_first_available_variant.id }}">
                </div>
                <div class="combo-buttons-block hide-for-mobile comb-button">
                    <div class="combo-wishlist" data-product-id="{{ combo_product_list.id }}"></div>
                    {% assign totalcomboprice = combo_product_list.price | plus: product.price %}
                    <button type="submit" class="product-form__add-button button button--primary cutom-button cartbutton">Add all to Cart {{ totalcomboprice | money }}</button>
                </div>
                <div class="combo-buttons-block sticky-on-mobile-combo hide-for-desktop">
                    <div class="combo-wishlist" data-product-id="{{ combo_product_list.id }}"></div>
                    {% assign totalcomboprice = combo_product_list.price | plus: product.price %}
                    <button type="submit" class="product-form__add-button button button--primary cutom-button cartbutton">Add all to Cart {{ totalcomboprice | money }}</button>
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">
    $(document).ready(function() {
        $('div.combo-product').click(function() {
            window.history.pushState('new-popup-state', null, '');
            $('.combo-product-modal').attr('aria-hidden', false);
        });
  
        $('.combo-product-modal .modal__close').click(function() {
            $('.combo-product-modal').attr('aria-hidden', true);
        });

        $('.cartbutton').click(function() {
            $('.cartbutton').prop('disabled', true);
            document.dispatchEvent(new CustomEvent('theme:loading:start'));
            $.ajax({
                url: '/cart/add.js',
                type: 'post',
                data: {
                    'items': [
                        {
                            'id': $('#popup-base-variant-id').val(),
                            'quantity': 1
                        },
                        {
                            'id': $('#popup-combo-variant-id').val(),
                            'quantity': 1
                        }
                    ]
                },
                success: function (response) {
                    $('.cartbutton').prop('disabled', false);
                    document.dispatchEvent(new CustomEvent('theme:loading:end'));
                    $('.cart-toast').addClass('show');
                    setTimeout(function() {
                       $('.cart-toast').removeClass('show');
                    }, 4000);
                    event = new CustomEvent('product:added', {
                        bubbles: true,
                        detail: {
                            quantity: parseInt(2)
                        }
                    });
                    $('html')[0].dispatchEvent(event);
                    $('.combo-product-modal').attr('aria-hidden', true);
                },
                error: function(jqXHR, textStatus, errorThrown) {
                    console.log(textStatus, errorThrown);
                    $('.cartbutton').prop('disabled', false);
                    $('.combo-product-modal').attr('aria-hidden', true);
                }   
            });
        });
    });
</script>
{% endif %}
